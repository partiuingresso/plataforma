<section class="section hero">
  <div class="container hero-content">
  </div>
</section>

<section class="section painel">
  <div class="container">
    <div class="columns is-centered">
        
        <div class="column is-3">        
          <%= render 'admin/admin_menu' if current_user.admin? %>
          <%= render 'admin/producer_admin_menu' if current_user.producer_admin? %>
        </div>


      <div class="column is-8">
        <p class="title is-size-2">Editar Empresa</p>

        <%= form_with(model: @company, local: true) do |f| %>
          <% if @company.errors.any? %>
            <article class="message signup is-danger">
              <div class="message-body">
                <h2><%= pluralize(product.errors.count, "erro") %> impediu que esta empresa fosse criada:</h2>
                <ul>
                <% product.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
                </ul>
              </div>
            </article>
          <% end %>

        <div class="tile is-ancestor">
          <div class="tile is-vertical is-8 is-parent">
            <div class="tile is-child box">
              <div class="field">
                <label class="label">Nome da Empresa</label>
                <div class="control has-icons-left has-icons-right">
                  <%= f.text_field :name, class: "input", placeholder: "Nome Fantasia" %>
                  <span class="icon is-small is-left">
                    <i class="far fa-building"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="tile is-child box">
              <label class="label is-size-5">Cadastrar Equipe</label>
              <div class="columns">
                <div class="column is-9">
                  <div class="field">
                    <label class="label">Email do Usuário</label>
                    <div class="control has-icons-left has-icons-right">
                      <%= fields_for @user.email do |e| %>
                      <%= e.email_field :email, class: "input", placeholder: "Email" %>
                      <% end %>
                      <span class="icon is-small is-left">
                        <i class="far fa-envelope"></i>
                      </span>
                    </div>
                  </div>
                </div>
                <div class="column is-3">
                  <div class="field">
                    <div class="control">
                      <label class="label">Função</label>
                      <div class="select">
                        <%= fields_for @user.role do |e| %>
                          <%= e.select :role, options_for_select([['Equipe', 1], ['Gerente', 2]]), include_blank: true %>
                        <% end %>   
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="tile is-child">
              <div class="control has-text-right">
                <%= f.button "Salvar", class: "button is-primary is-medium", data: { "disable-with": "<i class='fa fa-spinner fa-spin'></i> Aguarde..." } %>
                <% end %>
              </div>
            </div>
          </div>
          <div class="tile is-parent">
            <div class="tile is-child box">
              <label class="label is-size-5">Minha Equipe</label>
              <ul class="content">
                <% @staff.each do |s| %>
                  <li> 
                    <% if s.producer_admin? %>
                      <span class="has-text-grey content is-small">GERENTE</span>
                    <% end %>
                    <% if s.admin? %>
                      <span class="has-text-grey content is-small">EQUIPE</span>
                    <% end %>
                    <%= s.name.full %>
                    <% if s.id != current_user.id %>
                      <%= link_to remove_staff_path(:user_id => s.id), data: { confirm: "Deseja remover este usuário?" } do %>
                        <span class="icon is-small has-text-danger">
                          <i class="fas fa-times"></i>
                        </span>
                      <% end %>
                    <% end %>
                    </li>
                <% end %>
              </ul>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>
</section>